\documentclass[boxes]{homework}

% This is a slightly-more-than-minimal document that uses the homework class.
% See the README at http://git.io/vZWL0 for complete documentation.

\name{傅申 PB20000051}        % Replace (Your Name) with your name.
\term{2022 春}     % Replace (Current Term) with the current term.
\course{随机过程 B}    % Replace (Course Name) with the course name.
\hwnum{2}          % Replace (Number) with the number of the homework.
\hwname{作业}    
\problemname{习题}    
\solutionname{解:}

% Load any other packages you need here.
\usepackage[
    a4paper,
    top = 2.54cm,
    bottom = 2.54cm,
    left = 1.91cm,
    right = 1.91cm,
    includeheadfoot
]{geometry}
\fancyfootoffset{0pt} % make fancyhdr work properly
\usepackage{ctex}

\begin{document}
\problemnumber{2}
\begin{problem}
$\{N(t), t\geq 0\}$ 为一强度是 $\lambda$ 的 Poisson 过程. 对 $s > 0$ 试计算 $E[N(t)\cdot N(t+s)]$.
\end{problem}

\begin{solution}
我们对 $N(t)\cdot N(t+s)$ 稍作变换
\begin{equation}
    N(t)\cdot N(t+s) = N(t)\cdot [(N(t+s) - N(t)) + N(t)] = (N(t)-N(0))^2 + (N(t)-N(0))\cdot (N(t+s)-N(t))
\end{equation}
其中 $N(t)-N(0)$ 与 $N(t+s)-N(t)$ 相互独立. 而 $(N(t)-N(0))\sim \mathrm{Poisson}(\lambda t)$, 则有
\begin{equation}
    \begin{aligned}
        E[N(t)\cdot N(t+s)] &= E[(N(t)-N(0))^2] + E[(N(t)-N(0))\cdot (N(t+s)-N(t))] \\
        &= \mathrm{Var}[N(t)-N(0)] + E^2[N(t)-N(0)] + E[N(t)-N(0)]\cdot E[N(t+s)-N(t)] \\
        &= \lambda t + (\lambda t)^2 + \lambda t\cdot \lambda s \\
        &= \lambda t [1 + \lambda(t+s)]
    \end{aligned}
\end{equation}
\end{solution}

\problemnumber{4}
\begin{problem}
    $\{N(t), t\geq 0\}$ 为一 $\lambda = 2$ 的 Poisson 过程, 试求:
    \begin{parts}[r]
        \part
        \label{4.1}
        $P\{N(1)\leq 2\}$
        \part
        \label{4.2}
        $P\{N(1) = 1\text{ 且 }\ N(2) = 3\}$
        \part
        \label{4.3}
        $P\{N(1)\geq 2\vert N(1)\geq 1\}$
    \end{parts}
\end{problem}
\begin{solution}
    \ref{4.1}
    \begin{equation}
        \begin{aligned}
            P\{N(1)\leq 2\} &= \sum_{k=0}^{2} \frac{(\lambda)^k\exp(-\lambda)}{k!} \\
            &= \left(\frac{1}{1}+\frac{2}{1}+\frac{4}{2}\right)\exp(-2)\\
            &= 5\mathrm{e}^{-2}\approx 0.6767
        \end{aligned}
    \end{equation}
    \ref{4.2} $N(2)-N(1)$ 与 $N(1)$ 相互独立, 有
    \begin{equation}
        \begin{aligned}
            P\{N(1) = 1\text{ 且 }\ N(2) = 3\} &= P\{N(1) = 3\}\cdot P\{N(2) - N(1) = 2\vert N(1) = 3\}\\
            &= \mathrm{e}^{-2}\cdot P\{N(2) - N(1) = 2\}\\
            &= 2\mathrm{e}^{-2}\cdot 2\mathrm{e}^{-2}\\
            &= 4\mathrm{e}^{-4}\approx 0.0733
        \end{aligned}
    \end{equation}
    \ref{4.3} 显然 $P\{N(1)\ge 2, N(1)\ge 1\} = P\{N(1)\geq 2\}$, 有
    \begin{equation}
        P\{N(1)\geq 2\vert N(1)\geq 1\}=\frac{P\{N(1)\geq 2\}}{P\{N(1)\geq 1\}}=\frac{1-3\mathrm{e}^{-2}}{1-\mathrm{e}^{-2}}\approx 0.6870
    \end{equation}
\end{solution}
\problemnumber{7}
\begin{problem}
    $N(t)$ 是强度为 $\lambda$ 的 Poisson 过程. 给定 $N(t) = n$, 试求第 $r$ 个事件 ($r\leq n$) 发生的时刻 $W_r$ 的条件概率密度 $f_{W_r\vert N(t)=n}(w_r\vert n)$.
\end{problem}
\begin{solution}
    给定 $N(t) = n$, 不妨设 $W_r = w_r$. 对充分小的增量 $\Delta w_r\downarrow0$, 有
    \begin{equation}
        \begin{aligned}
            &\{w_r\leq W_r\leq w_r+\Delta w_r, N(t) = n\} \\
            &= \{N(w_r) = r-1, N(w_r+\Delta w_r)-N(w_r) = 1, N(t) - N(t - w_r - \Delta w_r) = n - r\}
        \end{aligned}
    \end{equation}
    记 $P_1 = P(N(w_r) = r-1, N(w_r+\Delta w_r)-N(w_r) = 1, N(t) - N(t - w_r - \Delta w_r) = n - r)$, 于是
    \begin{equation}
        \begin{aligned}
            f_{W_r\vert N(t)=n}(w_r\vert n)\Delta w_r &= P(w_r\leq W_r< w_r + \Delta w_r\vert N(t)=n) + o(\Delta w_r)\\
            &= \frac{P_1}{P(N(t) = n)} + o(\Delta w_r)
        \end{aligned}
    \end{equation}
    由独立增量性和 Poisson 过程的定义, 有
    \begin{gather}
        \begin{aligned}
            P_1 &= P(N(w_r) = r-1, N(w_r+\Delta w_r)-N(w_r) = 1, N(t) - N(t - w_r - \Delta w_r) = n - r)\\
            &= \frac{(\lambda w_r)^{r - 1}\exp(-\lambda w_r)}{(r - 1)!}(\lambda \Delta w_r + o(\Delta w_r))\frac{(\lambda (t - w_r - \Delta w_r))^{n - r}\exp(-\lambda (t - w_r - \Delta w_r))}{(n - r)!}\\
            &= \frac{\lambda^n}{(r-1)!(n-r)!}w_r^{r-1}(t - w_r - \Delta w_r)^{n - r}\exp(-\lambda t)\exp(\lambda \Delta w_r)\Delta w_r + o(\Delta w_r)
        \end{aligned}\\
        P(N(t) = n) = \frac{(\lambda t)^n\exp(-\lambda t)}{n!}
    \end{gather}
    因此, 得到
    \begin{equation}
        \begin{aligned}
            f_{W_r\vert N(t)=n}(w_r\vert n) &= \lim_{\Delta w_r\downarrow 0} \frac{P_1}{P(N(t) = n)\Delta w_r}\\
            &= \lim_{\Delta w_r\downarrow 0} \frac{n!}{(r-1)!(n-r)!}\frac{w_r^{r-1}(t - w_r - \Delta w_r)^{n - r}}{t^n}\exp(\lambda \Delta w_r)\\
            &= \frac{n!}{(r-1)!(n-r)!}\frac{w_r^{r-1}(t - w_r)^{n - r}}{t^n}
        \end{aligned}
    \end{equation}
\end{solution}
\begin{problem}
    令 $\{N_i(t), t\geq 0\}, i = 1,2,\cdots, n$ 为 $n$ 个独立的有相同强度参数为 $\lambda$ 的 Poisson 过程. 记 $T$ 为在全部 $n$ 个过程中至少发生了一件事的时刻, 试求 $T$ 的分布.
\end{problem}
\begin{solution}
    由题意可知
    \begin{equation}
        \{T>t\} = \{N_i(t) = 0, i = 1, 2, \cdots, n\}
    \end{equation}
    因此 
    \begin{equation}
        P(T>t) = \prod_{i = 1}^n P(N_i(t) = 0) = \prod_{i = 1}^n \exp(-\lambda t) = \exp(-n\lambda t)
    \end{equation}
    因此有
    \begin{gather}
        F_T(t) = 1 - \exp(-n\lambda t)\\
        f_T(t) = n\lambda \exp(-n\lambda t)
    \end{gather}
\end{solution}
\end{document}
